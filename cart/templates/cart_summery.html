
{% extends "base.html" %}
{% block content %}
{% load static %} 
{% load humanize %}


<!-- Header-->
    <header class="bg-dark py-5">
      <div class="container px-4 px-lg-5 my-5">
        <div class="text-center text-white">
          <h1 class="display-4 fw-bolder">Ø³Ø¨Ø¯Ø®Ø±ÛŒØ¯Ø´Ù…Ø§</h1>
          <p class="lead fw-normal text-white-50 mb-0">
         Ø§ÛŒÙ†Ø¬Ø§ Ù‡Ø±Ú†ÛŒ Ø¨Ø®ÙˆØ§ÛŒ Ø¨Ø®Ø±ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒØ´Ù‡
          </p>
        </div>
      </div>
    </header>
    <br><br><br><br><br><br>
   
   {% if cart_products %}
    {% for product in cart_products %}
    <div class="container ">

        <div class="card mb-3" >
  <div class="row g-0">
    <div class="col-md-4">
      <img src="{{product.image.url}}" class="img-fluid rounded-start" alt="...">
    </div>
    <div class="col-md-8">
      <div class="card-body">
        <h5 class="card-title">{{product.name}}</h5>
        <p class="card-text">{{product.description}}</p>
        <p class="card-text">
        {% if product.is_sale %}
          
          <strong> ğŸ’°Ù‚ÛŒÙ…Øª :<strike>{{product.price | intcomma}} ØªÙˆÙ…Ø§Ù† </strike>-{{product.sale_price | intcomma}} ØªÙˆÙ…Ø§Ù† </strong>
        {% else %}
           ğŸ’°Ù‚ÛŒÙ…Øª :{{product.price | intcomma}} ØªÙˆÙ…Ø§Ù† 
        {% endif %}

        <select class="form-select" id="select{{product.id}}">

           <p class="cart-text"> ØªØ¹Ø¯Ø§Ø¯:
         
          {% for key, value in quantities.items %}

         {% if key == product.id|slugify %}

        
          <option  selected>{{value}}</option>
          {% endif %}

         {% endfor %}
         </p> 

   
  <option value="1">1</option>
  <option value="2">2</option>
  <option value="3">3</option>
  <option value="4">4</option>
</select>

         
        <br>
        {% comment %} <button type="button" id="update" class="btn btn-primary"  data-index = '{{product.id}}'>ÙˆÛŒØ±Ø§ÛŒØ´</button> {% endcomment %}
        <button type="button" class="btn btn-primary update-cart" data-index = '{{product.id}}'>ÙˆÛŒØ±Ø§ÛŒØ´</button>
        <button type="button" class="btn btn-danger delete-cart" data-index = '{{product.id}}'>Ø­Ø°Ù</button>
        <a href="{% url 'home' %}" class="btn btn-secondary">Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ</a>
      </div>
    </div>
  </div>
</div>
      </div>
        <br><br>
        
      {% endfor %}  
    <h3 class="container">Ù…Ø¬Ù…ÙˆØ¹ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§: {{total | intcomma}} ØªÙˆÙ…Ø§Ù† </h3>
    <br>
  <center>  <a href="{% url 'checkout' %}" class="btn btn-success">ØµÙˆØ±ØªØ­Ø³Ø§Ø¨</a></center>
    <br><br><br>
    {% else %}

    
    <center><h1 class="container">Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª &#128531;</h1></center>
    {% endif %}

    <script >
       
                        
         $(document).on('click', '.update-cart', function(e){

             
           e.preventDefault();
          
           var productid = $(this).data('index');
          
                $.ajax({
                   type:'POST',
                    url:'{% url 'cart_update' %}',
                   
                    data:{
                        product_id: $(this).data("index"),
                        product_qty: $('#select'+productid+' option:selected').text(),
                       
                        csrfmiddlewaretoken:'{{csrf_token}}',
                        action:'post'
                    },
                   
                    success:function(json){
                     
                      
                      location.reload();
                       
                     
                       // alert("Ù…Ø­ØµÙˆÙ„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯");
                    },
                    error:function(xhr,errmsg,err){
                       // alert("Ø®Ø·Ø§ Ø¯Ø± Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„ Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯");
                    }
                });
           
           }); 

           
          $(document).on('click', '.delete-cart', function(e){

             
           e.preventDefault();
          
           
          
                $.ajax({
                   type:'POST',
                    url:'{% url 'cart_delete' %}',
                   
                    data:{
                        product_id: $(this).data("index"),
                       
                        csrfmiddlewaretoken:'{{csrf_token}}',
                        action:'post'
                    },
                   
                    success:function(json){
                     
                      
                      location.reload();
                       
                     
                       // alert("Ù…Ø­ØµÙˆÙ„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯");
                    },
                    error:function(xhr,errmsg,err){
                       // alert("Ø®Ø·Ø§ Ø¯Ø± Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„ Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯");
                    }
                });
           
           });    
        
    </script>
{% endblock %}
   
   
